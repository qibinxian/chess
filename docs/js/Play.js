var play=play||{};play.init=function(){this.my=1,this.map=Chess.initMap.arr2Clone(),this.nowManKey=!1,this.pace=[],this.isPlay=!0,this.mans=Chess.mans,this.bylaw=Chess.bylaw,this.depth=this.depth||3,this.isFoul=!1,Chess._ManShow()},play.ClickChecker=function(s){if(this.isPlay&&s.charAt(0)>="A"&&s.charAt(0)<="Z")return!1;1==this.my&&this.isPlay&&this.clickMan(s)},play.clickMan=function(s){var e=Chess.mans[s];1==e.args.my&&(Chess.mans[this.nowManKey]&&(Chess.mans[this.nowManKey].alpha=1),Chess.removeSign(),e.alpha=.6,this.nowManKey=s,Chess.mans[s].ps=Chess.mans[s].DropPoint(),Chess.createPromp())},play.checkFoul=function(){var s=this.pace,e=parseInt(s.length,10);return e>11&&s[e-1]==s[e-5]&&s[e-5]==s[e-9]&&s[e-4].split("")},play.clickPoint=function(s){var e=Chess.mans[this.nowManKey];s.eat&&(s.eat.destroy(),delete Chess.mans[this.map[s.y][s.x]]),delete this.map[e.CheckerY][e.CheckerX],this.map[s.y][s.x]=this.nowManKey,this.pace.push(""+e.CheckerX+e.CheckerY+s.x+s.y),Chess.createSign([e.CheckerX,e.CheckerY,s.x,s.y]),e.alpha=1,e.CheckerX=s.x,e.CheckerY=s.y,Chess.removePromp(),Chess._ManShow(),this.nowManKey=!1,Laya.timer.once(500,this,this.AIPlay),this.isFoul=this.checkFoul(),this.isFoul?console.log("长将不要脸"):console.log()},play.regret=function(){for(var s in Chess.removePromp(),Chess.removeSign(),Chess.mans)Chess.mans[s].destroy();var e=this.pace;e.pop(),e.pop();var h=Chess.initMap.arr2Clone();Chess.createMans();for(var a=0;a<e.length;a++){var i=e[a].split(""),n=1*i[0],t=1*i[1],o=1*i[2],r=1*i[3],c=(s=h[t][n],h[r][o]);c&&(Chess.mans[c].destroy,delete Chess.mans[c]),Chess.mans[s].CheckerX=o,Chess.mans[s].CheckerY=r,h[r][o]=s,delete h[t][n]}Chess._ManShow(),this.map=h,this.my=1,this.isPlay=!0},play.AIclickPoint=function(s,e,h){var a=Chess.mans[this.nowManKey];delete this.map[Chess.mans[this.nowManKey].CheckerY][Chess.mans[this.nowManKey].CheckerX],this.map[h][e]=this.nowManKey,a.CheckerX=e,a.CheckerY=h,Chess._ManShow(),this.nowManKey=!1,this.my=1,s&&(Chess.mans[s].destroy(),delete Chess.mans[s],"j0"==s&&this.showWin(-1),"J0"==s&&this.showWin(1))},play.AIPlay=function(){this.my=-1;var s=AI.init(this.pace.join(""));if(s){Chess.createSign(s),this.pace.push(s.join(""));var e=this.map[s[1]][s[0]];this.nowManKey=e;e=this.map[s[3]][s[2]];this.AIclickPoint(e,s[2],s[3])}else this.showWin(1)},play.showWin=function(s){this.isPlay=!1;var e=null;1==s?(console.log("你赢了"),e="恭喜你，你赢了，是否重开"):(console.log("你输了"),e="很可惜，你输了，是否重开"),new Confirm(e,this,function(s){if(s){for(var e in Chess.mans)Chess.mans[e].destroy();Chess.createMans(),this.init()}})};